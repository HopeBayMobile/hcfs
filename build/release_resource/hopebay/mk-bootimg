#!/bin/sh

if [ "$1" = "-h" -o $# -ne 1 ]; then     
        echo
        echo "  Usage: `basename $0` bootImageName"        
		echo "  Example:"
		echo "           `basename $0` bootimg/"
        echo
        exit 1
fi

currentDir=`pwd`
sourceDir=`dirname $1` 
cd ${sourceDir}                                                                 
sourceDir=`pwd`

cd ${currentDir}

workDir=${sourceDir}
origBootimgName=boot.img.orig
newBootimgName=boot.img
newRamdiskImageName=ramdisk.img
ramdiskImageName=${origBootimgName}-ramdisk.gz
kernelImageName=${origBootimgName}-kernel

newBootimg=${workDir}/${newBootimgName}
extractDir=${workDir}/bootimg

ramdiskDir=${extractDir}/root
kernelImage=${extractDir}/${kernelImageName}
newRamdiskImage=${extractDir}/${newRamdiskImageName}

cd ${extractDir}
mk-ramdisk ${ramdiskDir}

mkbootimg-mtk-50  --kernel ${kernelImage} --ramdisk ${newRamdiskImage} --cmdline "bootopt=64S3,32N2,32N2" --base 0x40000000 --ramdisk_offset 0x04000000 --kernel_offset 0x00008000 --tags_offset 0xE000000 --board 1452480747 --kernel_offset 0x00008000 --ramdisk_offset 0x04000000 --tags_offset 0xE000000 --output ${newBootimg}

# mtk original command for mkbootimg
#out/host/linux-x86/bin/mkbootimg  --kernel out/target/product/sim6735_35gu_b_l1/kernel --ramdisk out/target/product/sim6735_35gu_b_l1/ramdisk.img --cmdline "bootopt=64S3,32N2,32N2" --base 0x40000000 --ramdisk_offset 0x04000000 --kernel_offset 0x00008000 --tags_offset 0xE000000 --board 1452480747 --kernel_offset 0x00008000 --ramdisk_offset 0x04000000 --tags_offset 0xE000000 --output out/target/product/sim6735_35gu_b_l1/boot.img
