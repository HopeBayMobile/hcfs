# A sample Makefile for building Google Test and using it in user
# tests.  Please tweak it to suit your environment and project.  You
# may want to move it to your project's root directory.
#
# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.

HCFS_ROOT ?= $(realpath ../../../../..)
mkfile_path := $(realpath $(lastword $(MAKEFILE_LIST)))
MD_PATH := $(realpath $(dir $(mkfile_path)))
USER_DIR := $(realpath $(dir $(mkfile_path))/unittests) \
  $(realpath $(HCFS_ROOT)/src/HCFS) \

include $(realpath $(HCFS_ROOT)/tests/unit_test/c/unittest_modules/common.mk)

$(eval $(call ADDMODULE))

# All tests produced by this Makefile.

BATCH_UT := 1
$(eval $(call ADDTEST, hcfs_fromcloud_unittest, \
  fromcloud_mock_function.o \
  hcfs_fromcloud.o \
  hcfs_fromcloud_unittest.o ))

$(eval $(call ADDTEST, hcfs_tocloud_unittest, \
  b64encode.o \
  enc.o \
  compress.o \
  objmeta.o \
  dedup_mock_function.o \
  tocloud_mock_function.o \
  hcfs_tocloud.o \
  hcfs_tocloud_unittest.o ))

BATCH_UT := 1
$(eval $(call ADDTEST, hcfs_clouddelete_unittest, \
  clouddelete_mock_function.o \
  hcfs_clouddelete.o \
  hcfs_clouddelete_unittest.o ))

$(eval $(call ADDTEST, atomic_tocloud_unittest, \
  atomic_tocloud_mock_function.o \
  atomic_tocloud.o \
  atomic_tocloud_unittest.o ))

$(eval $(call ADDTEST, tocloud_tools_unittest, \
  tocloud_tools_mock_function.o \
  tocloud_tools.o \
  tocloud_tools_unittest.o ))
