# A sample Makefile for building Google Test and using it in user
# tests.  Please tweak it to suit your environment and project.  You
# may want to move it to your project's root directory.
#
# SYNOPSIS:
#
#   make [all]  - makes everything.
#   make TARGET - makes the given target.
#   make clean  - removes all files generated by make.

HCFS_ROOT ?= $(realpath ../../../../..)
mkfile_path := $(realpath $(lastword $(MAKEFILE_LIST)))
MD_PATH := $(realpath $(dir $(mkfile_path)))
USER_DIR := $(realpath $(dir $(mkfile_path))/unittests) \
  $(realpath $(HCFS_ROOT)/src/HCFS) \

include $(realpath $(HCFS_ROOT)/tests/unit_test/c/unittest_modules/common.mk)

$(eval $(call ADDMODULE))

# All tests produced by this Makefile.

$(eval $(call ADDTEST, utils_unittest, \
  utils.o \
  utils_fakeftn.o \
  utils_unittest.o ))

$(eval $(call ADDTEST, dir_entry_btree_unittest, \
  dir_entry_btree_fakeftn.o \
  dir_entry_btree.o \
  dir_entry_btree_unittest.o ))

$(eval $(call ADDTEST, logger_unittest, \
  logger.o \
  logger_unittest.o ))

$(eval $(call ADDTEST, pkg_cache_unittest, \
  pkg_cache.o \
  pkg_cache_mock_ftn.o \
  pkg_cache_unittest.o ))

$(eval $(call ADDTEST, syncpoint_control_unittest, \
  syncpoint_control.o \
  syncpoint_control_mock_ftn.o \
  syncpoint_control_unittest.o ))

$(eval $(call ADDTEST, meta_iterator_unittest, \
  meta_iterator.o \
  meta_iterator_mock_ftn.o \
  meta_iterator_unittest.o ))

$(eval $(call ADDTEST, hash_list_struct_unittest, \
  hash_list_struct.o \
  hash_list_struct_mock_ftn.o \
  hash_list_struct_unittest.o ))
