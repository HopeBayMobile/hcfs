{% extends "dashboard/base.html" %}
{% block javascript %}
    <script type="text/javascript">

        toogle_progress = (function(target){
            var toogle_indicator = 1;
            function return_func(){
                var num = toogle_indicator % 2 + 1;
                $(target).attr("src", "/static/img/dashboard/in_progress_0" + num + ".png");
                toogle_indicator += 1;
            }
            return return_func
        })("#progress-light");

        $(function(){
            $("body").on("click", ".menu-button.select", function(){
                actived = $(".menu-button.select.active")
                if (actived.length){
                    if (!actived.filter(this).length){
                        actived.removeClass("active");
                        $(this).addClass("active");
                    } else {
                        $(this).addClass("active");
                        $("#bottom-popup").animate({"height": "0px"}, 1000);
                        $(".bottom-popup-spacer").hide(1000);
                        $(this).removeClass("active");
                        toggle_checkbox();
                    }
                } else {
                    $("#bottom-popup").animate({"height": "50px"}, 1000);
                    $(".bottom-popup-spacer").show(1000);
                    $(this).addClass("active");
                    toggle_checkbox();
                }
            });
            // setInterval(toogle_progress, 500);

            $(".menu-button.create").on("click", function(){
                $.post('/dashboard/snapshot/create', function(ctnt, success, opts){
                    console.log(ctnt);
                });
            });
        });

        function toggle_checkbox(){
            $("#snapshot-list tr > :nth-child(1)").toggleClass("hide");
        }
    </script>
{% endblock javascript %}
{% block tab_content %}
    <ul class="nav nav-tabs">
        <li class="active"><a href="#snapshot" data-toggle="tab">Snapshot</a></li>
        <li class=""><a href="#schedule" data-toggle="tab">Schedule</a></li>
        <li class=""><a href="#lifecycle" data-toggle="tab">Life Cycle</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="snapshot" style="">
            <button class="menu-button create">Create</button>
            <button class="menu-button select">Delete</button>
            <button class="menu-button select">Export</button>
            <div id="" style="">
                <table id="snapshot-list" class="table table-striped table-bordered table-condensed">
                    <thead>
                      <tr>
                        <th class="span1 hide">#</th>
                        <th class="span2">Snapshot ID</th>
                        <th class="span1">Usage</th>
                        <th class="span2">Time</th>
                        <th style="width: 75px;">Status</th>
                        <th class="span1">Export</th>
                        <th class="span2">Path</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for snapshot in snapshots %}
                    <tr>
                        <td class="hide"><input type="checkbox" name="" value=""></td>
                        <td>{{ snapshot.name }}</td>
                        <td>{{ snapshot.total_size}}GB({{snapshot.num_files}})</td>
                        <td>{{ snapshot.start_time|date:"Y-m-d h:i"}}<br>|<br>{{ snapshot.finish_time|date:"Y-m-d h:i"}}</td>
                        <td>{% if snapshot.status %}
                            <img id="progress-light" src="/static/img/dashboard/in_progress_01.png" alt=""><br>
                            <!--div class="ani-inprogress"></div-->
                            In Progress{% else %}Complete{% endif %}</td>
                        <td>{% if snapshot.exposed %}<img src="/static/img/dashboard/export.png" alt="">{% endif %}</td>
                        <td>{{ snapshot.path}}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7">You don't have any snapshots.</td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="bottom-popup-spacer"></div>
            <div id="bottom-popup">
                <button id="select-cancel">Cancel</button>
                <button id="do-action">Done</button>
            </div>
        </div>
        <style type='text/css'>
            .schedule_button {
                display: block;
                height: 71px;
                width: 66px;
                float: left;
                background: url('/static/img/dashboard/radio_btn_01.png') no-repeat;
                background-position: left 0px;
                text-indent: -99999px;
            }
            .schedule_button:hover {
                background: url('/static/img/dashboard/radio_btn_02.png') no-repeat;
                background-position: left 0px;
            }
            .schedule_sub_div {
                height: 71px;
                margin-left: 40px;
                margin-top: 15px;
                font-size: 23px;
            }
            .schedule_sub_font_div {
                text-indent: 15px;
                padding-top: 25px;
            }
            .radio_button_div {
                margin-right: 20px;
            }
            .search_div {
                margin-top: 10px;
                text-indent: 120px;
                font-size: 23px;
            }
            .search_option_div {
                text-indent: 120px;
                margin-top: 20px;
                font-size: 23px;
            }
            .submit_button_div {
                text-indent: 450px;
                font-size: 23px;
            }
            .submit_button {
                border: none;
                width: 147px;
                height: 47px;
                background:url(/static/img/wizard/wizard_button.png) no-repeat;
            }
            .button_text {
                font-size: 23px;
                color: white;
            }
            .days_div {
                margin-top: 50px;
                font-size: 23px;
            }
        </style>
        <div class="tab-pane" id="schedule">
            <form action="/dashboard/snapshot/schedule" method="POST">
            {% csrf_token %}
            <div class="schedule_sub_div">
                <div class="radio_button_div">
                    <a href="#" class="schedule_button" >button</a>
                </div>
                <div style="width: 10px;"></div>
                <div class="schedule_sub_font_div">
                    None
                </div>
            </div>
            <div class="schedule_sub_div">
                <a href="#" class="schedule_button" >button</a>
                <div class="schedule_sub_font_div">
                    Snapshot by schedule
                </div>
            </div>
            <div class="search_div">
                Start from:
            </div>
            <div class="search_option_div">
                <select id="select-day" name="select-day">
                {% for key, value in the_day.items %}
                    {% if value == snapshot_time %}
                        <option selected>{{ value }}</option>
                    {% else %}
                        <option>{{ value }}</option>
                    {% endif %}
                {% endfor %}
            </select>
            </div>
            <div class="submit_button_div">
                <button type="submit" value="Modify" class="submit_button" alt="Submit">
                    <div class="button_text">Modify</div>
                </button>
            </div>
            </form>
        </div>
        <div class="tab-pane" id="lifecycle">
            <form action="/dashboard/snapshot/lifecycle" method="POST">
            {% csrf_token %}
            <div class="schedule_sub_div">
                SnapShot Life Cycle:<br /><br />
                Snapshots will be Delete after<br />
                <div class="days_div">
                    <input name="days" type="number" min="1" max="365" value="{{ default_day }}" /> days
                </div>
                <div class="submit_button_div">
                    <button type="submit" value="Modify" class="submit_button" alt="Submit">
                        <div class="button_text">Modify</div>
                    </button>
                </div>
            </div>
            </form>
        </div>
    </div>
{% endblock tab_content %}
