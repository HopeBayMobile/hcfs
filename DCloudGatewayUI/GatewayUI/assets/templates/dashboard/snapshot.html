{% extends "dashboard/base.html" %}
{% block javascript %}
    <script type="text/javascript">

        toogle_progress = (function(target){
            var toogle_indicator = 1;
            function return_func(){
                var num = toogle_indicator % 2 + 1;
                $(target).attr("src", "/static/img/dashboard/in_progress_0" + num + ".png");
                toogle_indicator += 1;
            }
            return return_func
        })("#progress-light");

        $(function(){
            $("body").on("click", ".menu-button.select", function(){
                actived = $(".menu-button.select.active")
                if (actived.length){
                    if (!actived.filter(this).length){
                        actived.removeClass("active");
                        $(this).addClass("active");
                    } else {
                        $(this).addClass("active");
                        $("#bottom-popup").animate({"height": "0px"}, 1000);
                        $(".bottom-popup-spacer").hide(1000);
                        $(this).removeClass("active");
                        toggle_checkbox();
                    }
                } else {
                    $("#bottom-popup").animate({"height": "50px"}, 1000);
                    $(".bottom-popup-spacer").show(1000);
                    $(this).addClass("active");
                    toggle_checkbox();
                }
            });
            // setInterval(toogle_progress, 500);

            $(".menu-button.create").on("click", function(){
                $.post('/dashboard/snapshot/create', function(ctnt, success, opts){
                    console.log(ctnt);
                });
            });
        });

        function toggle_checkbox(){
            $("#snapshot-list tr > :nth-child(1)").toggleClass("hide");
        }
    </script>
{% endblock javascript %}
{% block tab_content %}
    <ul class="nav nav-tabs">
        <li class="active"><a href="#snapshot" data-toggle="tab">Snapshot</a></li>
        <li class=""><a href="#schedule" data-toggle="tab">Schedule</a></li>
    </ul>
    <div class="tab-content">
        <div class="tab-pane active" id="snapshot" style="">
            <button class="menu-button create">Create</button>
            <button class="menu-button select">Delete</button>
            <button class="menu-button select">Export</button>
            <div id="" style="">
                <table id="snapshot-list" class="table table-striped table-bordered table-condensed">
                    <thead>
                      <tr>
                        <th class="span1 hide">#</th>
                        <th class="span2">Snapshot ID</th>
                        <th class="span1">Usage</th>
                        <th class="span2">Time</th>
                        <th style="width: 75px;">Status</th>
                        <th class="span1">Export</th>
                        <th class="span2">Path</th>
                      </tr>
                    </thead>
                    <tbody>
                    {% for snapshot in snapshots %}
                    <tr>
                        <td class="hide"><input type="checkbox" name="" value=""></td>
                        <td>{{ snapshot.name }}</td>
                        <td>{{ snapshot.total_size}}GB({{snapshot.num_files}})</td>
                        <td>{{ snapshot.start_time|date:"Y-m-d h:i"}}<br>|<br>{{ snapshot.finish_time|date:"Y-m-d h:i"}}</td>
                        <td>{% if snapshot.status %}
                            <img id="progress-light" src="/static/img/dashboard/in_progress_01.png" alt=""><br>
                            <!--div class="ani-inprogress"></div-->
                            In Progress{% else %}Complete{% endif %}</td>
                        <td>{% if snapshot.exposed %}<img src="/static/img/dashboard/export.png" alt="">{% endif %}</td>
                        <td>{{ snapshot.path}}</td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="7">You don't have any snapshots.</td>
                    </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
            <div class="bottom-popup-spacer"></div>
        </div>
        <div class="tab-pane" id="schedule">
            This is the schedule view.
        </div>
    </div>

{% endblock tab_content %}
